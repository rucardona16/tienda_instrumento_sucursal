"use strict";angular.module("yapp",["ui.router","ngAnimate","base64"]).run(["$rootScope","$location","$state",function(t,e,o){t.url="http://localhost:8080/",t.$on("$stateChangeStart",function(t,o,r,a,n){var l=localStorage.getItem("token");l||(e.path("/login"),console.log("cambio"))})}]).factory("AuthInterceptor",function(){return{request:function(t){t.headers=t.headers||{};var e=btoa("bill:abc123");return t.headers.Authorization="Basic "+e,t}}}).config(["$stateProvider","$urlRouterProvider","$httpProvider",function(t,e,o){o.interceptors.push("AuthInterceptor"),o.defaults.useXDomain=!0,delete o.defaults.headers.common["X-Requested-With"],e.when("/dashboard","/dashboard/overview"),e.otherwise("/login"),t.state("base",{"abstract":!0,url:"",templateUrl:"views/base.html"}).state("login",{url:"/login",parent:"base",templateUrl:"views/login.html",controller:"LoginCtrl"}).state("dashboard",{url:"/dashboard",parent:"base",templateUrl:"views/dashboard.html",controller:"DashboardCtrl"}).state("overview",{url:"/overview",parent:"dashboard",templateUrl:"views/dashboard/overview.html"}).state("reports",{url:"/reports",parent:"dashboard",templateUrl:"views/dashboard/reports.html"})}]),angular.module("yapp").controller("LoginCtrl",["$scope","$location","$http","$q","$rootScope","$base64",function(t,e,o,r,a,n){function l(e){t.token=n.encode(t.user+":"+t.password);var l=r.defer(),s={method:"GET",url:a.url+"user/login",headers:{Authorization:"Basic "+t.token}};return o(s).then(function(t){l.resolve(t)},function(t){l.resolve(t)}),l.promise}t.login={},t.token=null,t.submit=function(o){l().then(function(o){"200"==o.status?(localStorage.setItem("token",t.token),e.path("/dashboard")):alert("Error de credenciales")},function(t){console.log(t)})}}]),angular.module("yapp").controller("DashboardCtrl",["$scope","$state","$q","$http","$rootScope","$location",function(t,e,o,r,a,n){function l(t){var e=o.defer(),n={method:"POST",url:a.url+"productos",headers:{Authorization:"Basic "+localStorage.getItem("token")},data:t};return r(n).then(function(t){e.resolve(t)},function(t){e.resolve(t)}),e.promise}function s(t){var e=o.defer(),n={method:"GET",url:a.url+"productos/"+t,headers:{Authorization:"Basic "+localStorage.getItem("token")}};return r(n).then(function(t){e.resolve(t)},function(t){e.resolve(t)}),e.promise}function i(){var t=o.defer(),e={method:"GET",url:a.url+"logout",headers:{Authorization:"Basic "+localStorage.getItem("token")}};return r(e).then(function(e){t.resolve(e)},function(e){t.resolve(e)}),t.promise}t.datos={},t.palabra={},t.logout=function(){i().then(function(t){localStorage.removeItem("token"),n.path("/login")},function(t){console.log(t)})},t.buscar=function(){s(t.palabra.valor).then(function(e){"200"==e.status?(t.productos=e.data,t.palabra={}):alert("Verifica su coneccion a internet")},function(t){console.log(t)})},t.registrar=function(){l(t.datos).then(function(e){"200"==e.status?(t.datos={},alert("Producto agregado"),n.path("/dashboard/reports")):alert("Verifica su coneccion a internet")},function(t){console.log(t)})}}]);